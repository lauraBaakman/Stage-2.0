(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11267,        308]
NotebookOptionsPosition[     10708,        284]
NotebookOutlinePosition[     11094,        301]
CellTagsIndexPosition[     11051,        298]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";", 
  RowBox[{"Clear", "[", "Derivative", "]"}], ";", " ", 
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", " ", "=", " ", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d", " ", "\[GreaterEqual]", " ", "1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Element", "[", 
       RowBox[{"d", ",", " ", "Integers"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Element", "[", 
       RowBox[{"x", ",", " ", 
        RowBox[{"Vectors", "[", "d", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Definitions", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"unitSphereVolume", "  ", "=", " ", 
    FractionBox[
     SuperscriptBox["pi", 
      FractionBox["d", "2"]], 
     RowBox[{"Gamma", "[", 
      RowBox[{
       FractionBox["d", "2"], " ", "+", " ", "1"}], "]"}]]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"epan", " ", "[", "t_", "]"}], "=", " ", 
    RowBox[{"Piecewise", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"d", " ", "+", " ", "2"}], 
           RowBox[{"2", " ", "*", " ", "unitSphereVolume"}]], 
          RowBox[{"(", 
           RowBox[{"1", " ", "-", " ", 
            RowBox[{"Dot", "[", 
             RowBox[{"t", ",", " ", "t"}], "]"}]}], ")"}]}], ",", " ", 
         RowBox[{
          RowBox[{"Dot", "[", 
           RowBox[{"t", ",", " ", "t"}], "]"}], " ", "<", " ", "1"}]}], "}"}],
        "}"}], ",", " ", "\[IndentingNewLine]", "0"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EV", "[", "_t", "]"}], " ", "=", " ", 
  RowBox[{"Refine", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"t", " ", "*", " ", 
       RowBox[{"epan", "[", "t", "]"}]}], ",", " ", "t"}], "]"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Element", "[", 
     RowBox[{"t", ",", " ", 
      RowBox[{"Vectors", "[", "d", "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "[", "_t", "]"}], " ", "=", " ", 
  RowBox[{"Refine", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"EV", "[", 
      SuperscriptBox["t", "2"], "]"}], " ", "-", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"EV", "[", "t", "]"}], ")"}], "2"]}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Element", "[", 
     RowBox[{"t", ",", " ", 
      RowBox[{"Vectors", "[", "d", "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Function", "[", 
  RowBox[{"V", "[", "x", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.703829555722725*^9, 3.703829556332098*^9}, {
   3.703829592252225*^9, 3.7038296644342527`*^9}, {3.703829745397951*^9, 
   3.703829769734456*^9}, {3.703829835476596*^9, 3.7038298636277637`*^9}, {
   3.7038299240239153`*^9, 3.7038300651177053`*^9}, 3.703830120332326*^9, {
   3.703830239922538*^9, 3.703830240383794*^9}, {3.703830275487525*^9, 
   3.7038302784877453`*^9}, {3.7038303312301207`*^9, 3.703830391548498*^9}, {
   3.703830478025589*^9, 3.70383051068097*^9}, {3.703830546528281*^9, 
   3.703830596143553*^9}, {3.703830632478073*^9, 3.703830676140141*^9}, {
   3.703830787970479*^9, 3.7038308004407253`*^9}, {3.7038308924399147`*^9, 
   3.703830915494648*^9}, {3.703835827244573*^9, 3.70383594837422*^9}, {
   3.7038360067150183`*^9, 3.703836020253592*^9}, {3.703836064962308*^9, 
   3.703836066049151*^9}, {3.7038361376074467`*^9, 3.7038361734225063`*^9}, {
   3.703836255251155*^9, 3.70383625841899*^9}, {3.703836523595468*^9, 
   3.703836541578998*^9}, {3.703837007879785*^9, 3.703837066323715*^9}, 
   3.7038374498820543`*^9, {3.70383748980904*^9, 3.703837528231876*^9}, {
   3.703837671479925*^9, 3.703837712843652*^9}, {3.703837846503336*^9, 
   3.703837893357875*^9}, {3.703837938340432*^9, 3.7038379470361137`*^9}, {
   3.703837993314394*^9, 3.703838010906603*^9}, {3.703838054311858*^9, 
   3.7038380684832363`*^9}, {3.70383811160797*^9, 3.703838200140359*^9}, {
   3.703838255091475*^9, 3.7038383184737864`*^9}, {3.703838351962508*^9, 
   3.7038383604484453`*^9}, {3.7038384362061243`*^9, 3.703838522556367*^9}, {
   3.703838566626933*^9, 3.703838651351615*^9}, {3.70383880541698*^9, 
   3.703838824229982*^9}, {3.703838855319706*^9, 3.70383886054275*^9}, {
   3.703839032250657*^9, 3.703839086887233*^9}, {3.7038399767836933`*^9, 
   3.703840013077469*^9}, {3.7038403462208433`*^9, 3.70384034778415*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", " ", 
   RowBox[{"(", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", "d"}], ")"}], " ", 
            SuperscriptBox["pi", 
             RowBox[{
              RowBox[{"-", "d"}], "/", "2"}]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"1", ".", "t"}], "+", 
              RowBox[{"t", ".", "1"}]}], ")"}], " ", 
            RowBox[{"Gamma", "[", 
             RowBox[{"1", "+", 
              FractionBox["d", "2"]}], "]"}]}], 
           RowBox[{
            RowBox[{"t", ".", "t"}], "<", "1"}]},
          {"0", 
           TagBox["True",
            "PiecewiseDefault",
            AutoDelete->True]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False], ")"}]}], "+", 
  RowBox[{"(", 
   TagBox[GridBox[{
      {"\[Piecewise]", GridBox[{
         {
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", "d"}], ")"}], " ", 
           SuperscriptBox["pi", 
            RowBox[{
             RowBox[{"-", "d"}], "/", "2"}]], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"t", ".", "t"}]}], ")"}], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{"1", "+", 
             FractionBox["d", "2"]}], "]"}]}], 
          RowBox[{
           RowBox[{"t", ".", "t"}], "<", "1"}]},
         {"0", 
          TagBox["True",
           "PiecewiseDefault",
           AutoDelete->True]}
        },
        AllowedDimensions->{2, Automatic},
        Editable->True,
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.84]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}},
        Selectable->True]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.35]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    "Piecewise",
    DeleteWithContents->True,
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ")"}]}]], "Output",
 CellChangeTimes->{{3.703838517967708*^9, 3.703838523092104*^9}, 
   3.7038386648569098`*^9, 3.703838827058263*^9, 3.703838861682684*^9, 
   3.703839081415202*^9, {3.703840003134509*^9, 3.703840013794279*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SuperscriptBox[
    RowBox[{"EV", "[", "t", "]"}], "2"]}], "+", 
  RowBox[{"EV", "[", 
   SuperscriptBox["t", "2"], "]"}]}]], "Output",
 CellChangeTimes->{{3.703838517967708*^9, 3.703838523092104*^9}, 
   3.7038386648569098`*^9, 3.703838827058263*^9, 3.703838861682684*^9, 
   3.703839081415202*^9, {3.703840003134509*^9, 3.703840013813817*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FunctionExpand", "[", 
  RowBox[{"V", "[", "x", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.703840033506925*^9, 3.703840040265841*^9}}],

Cell[BoxData[
 RowBox[{"V", "[", "x", "]"}]], "Output",
 CellChangeTimes->{{3.70384003601982*^9, 3.7038400406560583`*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.703838647391658*^9, 3.703838648968175*^9}}]
},
WindowSize->{1920, 1151},
WindowMargins->{{0, Automatic}, {Automatic, -1}},
Magnification:>1.25 Inherited,
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 28, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4755, 105, 641, "Input"],
Cell[5338, 129, 4545, 126, 70, "Output"],
Cell[9886, 257, 388, 9, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10311, 271, 161, 3, 39, InheritFromParent],
Cell[10475, 276, 122, 2, 39, "Output"]
}, Open  ]],
Cell[10612, 281, 92, 1, 39, "Input"]
}
]
*)

