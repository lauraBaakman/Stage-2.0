(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      7452,        181]
NotebookOptionsPosition[      7168,        166]
NotebookOutlinePosition[      7553,        183]
CellTagsIndexPosition[      7510,        180]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";", 
  RowBox[{"Clear", "[", "Derivative", "]"}], ";", " ", 
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"d", " ", "\[GreaterEqual]", " ", "1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Element", "[", 
      RowBox[{"d", ",", " ", "Integers"}], "]"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Element", "[", 
      RowBox[{"x", ",", " ", 
       RowBox[{"Vectors", "[", 
        RowBox[{"d", ",", " ", "Reals"}], "]"}]}], "]"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"unitSphereVolume", "  ", "=", " ", 
    FractionBox[
     SuperscriptBox["Pi", 
      FractionBox["d", "2"]], 
     RowBox[{"Gamma", "[", 
      RowBox[{
       FractionBox["d", "2"], " ", "+", " ", "1"}], "]"}]]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"epan", " ", "[", "t_", "]"}], "=", " ", 
   RowBox[{"Piecewise", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"d", " ", "+", " ", "2"}], 
          RowBox[{"2", " ", "*", " ", "unitSphereVolume"}]], 
         RowBox[{"(", 
          RowBox[{"1", " ", "-", " ", 
           RowBox[{"Dot", "[", 
            RowBox[{"t", ",", " ", "t"}], "]"}]}], ")"}]}], ",", " ", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{"t", ",", " ", "t"}], "]"}], " ", "<", " ", "1"}]}], "}"}], 
      "}"}], ",", " ", "\[IndentingNewLine]", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EV", "[", "t_", "]"}], " ", "=", " ", 
    RowBox[{"Refine", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"t", " ", "*", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"d", " ", "+", " ", "2"}], 
            RowBox[{"2", " ", "*", " ", "unitSphereVolume"}]], 
           RowBox[{"(", 
            RowBox[{"1", " ", "-", " ", 
             RowBox[{"Dot", "[", 
              RowBox[{"t", ",", " ", "t"}], "]"}]}], ")"}]}], ")"}]}], ",", 
        " ", 
        RowBox[{"{", "t", "}"}]}], "]"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Element", "[", 
        RowBox[{"t", ",", " ", 
         RowBox[{"Vectors", "[", 
          RowBox[{"d", ",", " ", "Reals"}], "]"}]}], "]"}], " ", "&&", " ", 
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"t", ",", " ", "t"}], "]"}], " ", "<", " ", "1"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V", "[", "t_", "]"}], " ", "=", " ", 
   RowBox[{"Refine", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"EV", "[", 
       SuperscriptBox["t", "2"], "]"}], " ", "-", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"EV", "[", "t", "]"}], ")"}], "2"]}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Element", "[", 
      RowBox[{"t", ",", " ", 
       RowBox[{"Vectors", "[", "d", "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"FullSimplify", "@", 
     RowBox[{"PiecewiseExpand", "@", 
      RowBox[{"V", "[", "x", "]"}]}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"FullSimplify", "@", 
     RowBox[{"PiecewiseExpand", "@", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"V", "[", "x", "]"}]}]}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.703829555722725*^9, 3.703829556332098*^9}, {
   3.703829592252225*^9, 3.7038296644342527`*^9}, {3.703829745397951*^9, 
   3.703829769734456*^9}, {3.703829835476596*^9, 3.7038298636277637`*^9}, {
   3.7038299240239153`*^9, 3.7038300651177053`*^9}, 3.703830120332326*^9, {
   3.703830239922538*^9, 3.703830240383794*^9}, {3.703830275487525*^9, 
   3.7038302784877453`*^9}, {3.7038303312301207`*^9, 3.703830391548498*^9}, {
   3.703830478025589*^9, 3.70383051068097*^9}, {3.703830546528281*^9, 
   3.703830596143553*^9}, {3.703830632478073*^9, 3.703830676140141*^9}, {
   3.703830787970479*^9, 3.7038308004407253`*^9}, {3.7038308924399147`*^9, 
   3.703830915494648*^9}, {3.703835827244573*^9, 3.70383594837422*^9}, {
   3.7038360067150183`*^9, 3.703836020253592*^9}, {3.703836064962308*^9, 
   3.703836066049151*^9}, {3.7038361376074467`*^9, 3.7038361734225063`*^9}, {
   3.703836255251155*^9, 3.70383625841899*^9}, {3.703836523595468*^9, 
   3.703836541578998*^9}, {3.703837007879785*^9, 3.703837066323715*^9}, 
   3.7038374498820543`*^9, {3.70383748980904*^9, 3.703837528231876*^9}, {
   3.703837671479925*^9, 3.703837712843652*^9}, {3.703837846503336*^9, 
   3.703837893357875*^9}, {3.703837938340432*^9, 3.7038379470361137`*^9}, {
   3.703837993314394*^9, 3.703838010906603*^9}, {3.703838054311858*^9, 
   3.7038380684832363`*^9}, {3.70383811160797*^9, 3.703838200140359*^9}, {
   3.703838255091475*^9, 3.7038383184737864`*^9}, {3.703838351962508*^9, 
   3.7038383604484453`*^9}, {3.7038384362061243`*^9, 3.703838522556367*^9}, {
   3.703838566626933*^9, 3.703838651351615*^9}, {3.70383880541698*^9, 
   3.703838824229982*^9}, {3.703838855319706*^9, 3.70383886054275*^9}, {
   3.703839032250657*^9, 3.703839086887233*^9}, {3.7038399767836933`*^9, 
   3.703840013077469*^9}, {3.7038403462208433`*^9, 3.70384034778415*^9}, {
   3.703844694063246*^9, 3.703844704433404*^9}, {3.7038447381684313`*^9, 
   3.703844747432186*^9}, {3.703844895620061*^9, 3.703844957104917*^9}, {
   3.7038450955903263`*^9, 3.703845150700067*^9}, {3.7038452102432127`*^9, 
   3.7038452357940283`*^9}, {3.7038461629124813`*^9, 
   3.7038461652327213`*^9}, {3.7038462229910717`*^9, 3.703846227324684*^9}, {
   3.7038463359637117`*^9, 3.703846390119554*^9}, {3.703846475310297*^9, 
   3.703846479741754*^9}, {3.703846573412897*^9, 3.7038465937048283`*^9}, {
   3.7038466659517403`*^9, 3.703846671287303*^9}, {3.7038467799810553`*^9, 
   3.703846783730644*^9}, {3.703846924952795*^9, 3.703846985827711*^9}, {
   3.703847059968611*^9, 3.703847111819126*^9}, {3.703848973632944*^9, 
   3.703849032841362*^9}, 3.703849090686802*^9, {3.703850076812999*^9, 
   3.703850097029364*^9}, {3.703850129997717*^9, 3.70385013757226*^9}, {
   3.703995455928459*^9, 3.703995545877344*^9}, {3.704004559229877*^9, 
   3.704004597466722*^9}, {3.704004632961899*^9, 3.704004636481969*^9}}]
},
WindowSize->{960, 1151},
WindowMargins->{{0, Automatic}, {Automatic, -1}},
Magnification:>1.25 Inherited,
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 28, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 6606, 144, 713, "Input"]
}
]
*)

