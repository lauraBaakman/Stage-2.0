(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      7462,        180]
NotebookOptionsPosition[      7058,        161]
NotebookOutlinePosition[      7412,        177]
CellTagsIndexPosition[      7369,        174]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"Clear", "[", "d", "]"}], "\[IndentingNewLine]", 
 RowBox[{"d", " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{"h", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VolumeRatio", "[", 
    RowBox[{"h_", ",", " ", "d_", ",", " ", "eigenvalues_"}], "]"}], " ", ":=",
    " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Power", "[", 
      RowBox[{
       RowBox[{"Sqrt", "[", "h", "]"}], ",", " ", "d"}], "]"}], ")"}], " ", 
    "/", " ", 
    RowBox[{"(", 
     RowBox[{"N", "[", 
      RowBox[{"Times", " ", "@@", " ", 
       RowBox[{"Sqrt", "[", "eigenvalues", "]"}]}], "]"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EigenValueRatio", "[", 
    RowBox[{"volumeRatio_", ",", " ", "d_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Power", "[", 
    RowBox[{"volumeRatio", ",", " ", 
     RowBox[{"1", " ", "/", " ", "d"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"covarianceMatrix", " ", "=", " ", 
     RowBox[{"h", " ", "*", " ", 
      RowBox[{"IdentityMatrix", "[", "d", "]"}]}]}], ";"}], "*)"}], 
  RowBox[{
   RowBox[{"covarianceMatrix", " ", "=", " ", 
    RowBox[{"IdentityMatrix", "[", "d", "]"}]}], ";"}]}]}], "Input",
 CellChangeTimes->{{3.702811023657406*^9, 3.702811048359315*^9}, {
   3.702811152078123*^9, 3.702811156492792*^9}, {3.702811276947111*^9, 
   3.702811278137525*^9}, {3.702811482588142*^9, 3.702811528603159*^9}, {
   3.702811620816401*^9, 3.7028116214046373`*^9}, {3.702812674012272*^9, 
   3.702812675340199*^9}, {3.702874092180113*^9, 3.702874104051421*^9}, {
   3.702874200162169*^9, 3.702874207376645*^9}, {3.702874436963238*^9, 
   3.702874437641674*^9}, 3.702874519889142*^9, 3.702874561771006*^9, {
   3.702874620668518*^9, 3.702874621862412*^9}, {3.702874770385024*^9, 
   3.702874772839635*^9}, {3.702874865326676*^9, 3.7028748658608837`*^9}, {
   3.702875394461006*^9, 3.702875394942503*^9}, {3.7028766474155817`*^9, 
   3.70287676899658*^9}, {3.702876820180608*^9, 3.702876821524156*^9}, {
   3.7028769098569613`*^9, 3.702876923647128*^9}, {3.702876984766265*^9, 
   3.702876990149301*^9}, {3.7028770240853157`*^9, 3.7028770543069563`*^9}, {
   3.702877134064884*^9, 3.70287713477667*^9}, {3.702877171143434*^9, 
   3.702877191358592*^9}, {3.7028772715513983`*^9, 3.7028772818602037`*^9}, {
   3.7028773432042627`*^9, 3.7028774255464582`*^9}, {3.7028774687118177`*^9, 
   3.7028774846972723`*^9}, {3.702877524038274*^9, 3.7028775372203827`*^9}, {
   3.7028776134902573`*^9, 3.7028776140818987`*^9}, {3.7028776448566427`*^9, 
   3.702877649847118*^9}, {3.702877698773394*^9, 3.702877716404172*^9}, {
   3.702878370065201*^9, 3.70287838216238*^9}, {3.7028784298890533`*^9, 
   3.70287850708657*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"eigenvalues", ",", "vecs"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", "covarianceMatrix", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"volumeRatio", " ", "=", " ", 
   RowBox[{"VolumeRatio", "[", 
    RowBox[{"h", ",", " ", "d", ",", " ", "eigenvalues"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"eigenValueRatio", " ", "=", 
  RowBox[{"EigenValueRatio", "[", 
   RowBox[{"volumeRatio", ",", " ", "d"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eigenValueScaleFactor", " ", "=", 
   RowBox[{"Power", "[", " ", 
    RowBox[{"eigenValueRatio", ",", " ", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"eigenValueScaleFactor", " ", "*", " ", "covarianceMatrix"}], 
     ",", " ", 
     RowBox[{
      RowBox[{"d", " ", "\[GreaterEqual]", " ", "1"}], " ", "&&", " ", 
      RowBox[{"h", " ", ">", " ", "0"}]}]}], "]"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.702811119408119*^9, 3.702811151011983*^9}, {
   3.702811200378583*^9, 3.7028113022484703`*^9}, {3.702811336207788*^9, 
   3.7028113836067047`*^9}, {3.702811533061384*^9, 3.70281161688833*^9}, {
   3.7028120776131077`*^9, 3.7028120806926622`*^9}, {3.7028121602878513`*^9, 
   3.7028122139367943`*^9}, {3.70281238561971*^9, 3.702812418091978*^9}, {
   3.70281247436234*^9, 3.702812488746155*^9}, {3.702812650511325*^9, 
   3.702812668771792*^9}, {3.702873910866148*^9, 3.7028739138331537`*^9}, {
   3.702874064716914*^9, 3.702874081592268*^9}, {3.702874120828045*^9, 
   3.702874122259543*^9}, {3.7028742081132174`*^9, 3.702874208979743*^9}, {
   3.702874458625865*^9, 3.702874507247813*^9}, {3.702874537551553*^9, 
   3.7028745871817617`*^9}, {3.70287463523622*^9, 3.702874640427814*^9}, {
   3.7028747171141453`*^9, 3.702874735220661*^9}, {3.7028747895281982`*^9, 
   3.7028747905913763`*^9}, {3.702875329694854*^9, 3.702875354998605*^9}, {
   3.702876204940631*^9, 3.7028762642514763`*^9}, 3.702876511915881*^9, {
   3.702876603609255*^9, 3.7028766132467012`*^9}, {3.7028767388052473`*^9, 
   3.702876755898726*^9}, {3.702876843786448*^9, 3.702876968278881*^9}, {
   3.702877001949716*^9, 3.702877003332971*^9}, {3.702877062313261*^9, 
   3.7028770857782297`*^9}, {3.702877129689642*^9, 3.7028771315370903`*^9}, {
   3.7028771632880287`*^9, 3.702877258749074*^9}, {3.702877346906763*^9, 
   3.702877347537931*^9}, {3.702877430239628*^9, 3.702877514229163*^9}, {
   3.702877546510058*^9, 3.7028776428412*^9}, {3.7028776797121353`*^9, 
   3.7028776885197067`*^9}, {3.7028783430518093`*^9, 3.702878361411381*^9}, {
   3.702878406643023*^9, 3.702878446152712*^9}}],

Cell[BoxData[
 RowBox[{"1.`", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    SuperscriptBox["h", "50"], ")"}], 
   RowBox[{"1", "/", "100"}]]}]], "Output",
 CellChangeTimes->{
  3.702876847817094*^9, {3.7028768954596767`*^9, 3.702876940357966*^9}, {
   3.702876978454048*^9, 3.702876994992586*^9}, 3.702877120697522*^9, 
   3.702877219653352*^9, 3.702877251557723*^9, 3.702877332829382*^9, 
   3.7028774383071003`*^9, {3.702877556479251*^9, 3.7028776542968388`*^9}, {
   3.7028776909532557`*^9, 3.702877719027528*^9}, {3.702878417418744*^9, 
   3.70287849893731*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Power", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Power", "[", 
      RowBox[{
       RowBox[{"Sqrt", "[", "bandwidth", "]"}], ",", " ", "dimension"}], 
      "]"}], ")"}], " ", "/", " ", "divisor"}], " ", ",", " ", 
   RowBox[{"1", " ", "/", " ", "dimension"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.702878534937892*^9, 3.702878583548233*^9}}]
},
WindowSize->{960, 1151},
WindowMargins->{{Automatic, 0}, {Automatic, -1}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 28, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2763, 57, 159, "Input"],
Cell[CellGroupData[{
Cell[3346, 81, 2735, 51, 117, "Input"],
Cell[6084, 134, 565, 12, 36, "Output"]
}, Open  ]],
Cell[6664, 149, 390, 10, 32, "Input"]
}
]
*)

