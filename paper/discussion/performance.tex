%!TEX root = ../paper.tex

% Hardly any difference between estimators
One of the most striking observations from \cref{s:results} is that the differences in performance between the two estimators are minimal. 
	
	% Study differences further mbe vs sambe plot
	Plotting the densities as estimated by \sambe as a function of those estimated by \mbe shows no interesting differences between the two estimators for dataset \ferdosiOne through \baakmanFive. 
		% Multi Sphere Sets
		However for dataset \ferdosiTwo through \baakmanThree these plots are interesting. As can be seen in \cref{fig:discussion:performance:two:mbevssambe} using shape-adaptive kernels results in estimated densities that are generally higher than those estimated with a fixed-shape kernel for dataset \ferdosiTwo and \baakmanTwo. A review of the raw data shows that the points whose density is estimated by \sambe to be significantly higher than \mbe, and nearer to the true density, can all be found near the mean of ``Trivariate Gaussian 1''. The kernels in this neighborhood are all slightly anisotropic, and have allowed the shape-adaptive estimator to use more data points, to better approximate the local densities. Thus showing that at least for some points estimating the density with shape-adaptive kernels is advantageous.
		%
		\begin{figure}
			\centering
			\begin{subfigure}{0.23\textwidth}
				\centering
				\includegraphics[keepaspectratio=true, width=\textwidth, height=0.23\textheight]{discussion/img/ferdosi_2_60000_mbe_sambe.png}
				\caption{Dataset \ferdosiTwo}
				\label{fig:discussion:performance:mbevssambe:ferdosi2}
			\end{subfigure}
			\begin{subfigure}{0.23\textwidth}
				\centering
				\includegraphics[keepaspectratio=true, width=\textwidth, height=0.23\textheight]{discussion/img/baakman_2_60000_mbe_sambe.png}
				\caption{Dataset \baakmanTwo}
				\label{fig:discussion:performance:mbevssambe:baakman2}
			\end{subfigure}	
			\caption{Plots of the density estimated by \sambe as a function of those estimated by \mbe for dataset %
				\subref{fig:discussion:performance:mbevssambe:ferdosi2} % 
				\ferdosiTwo and %
				\subref{fig:discussion:performance:mbevssambe:baakman2} %
				\baakmanTwo.
			}
			\label{fig:discussion:performance:two:mbevssambe}
		\end{figure}
		
		% Ferdosi 3 / Baakman 3
		\Cref{fig:discussion:performance:four:mbevssambe} shows the opposite effect; the densities estimated by \sambe for dataset \ferdosiThree and \baakmanThree are generally lower than those estimated by \mbe. Reviewing the raw data shows that the points with the greatest differences between the two estimators lie near the mean of the `Trivariate Gaussian 3' in both dataset \ferdosiThree and \baakmanThree. The number of points used in the density estimate by \sambe is consistently lower and than those used by the fixed-shape estimator. Given the relatively high anisotropy of the kernels in that area we expect that this is due to the kernels reflecting fine local structures, that are not relevant to the more global neighborhood. 
		%	
		\begin{figure}
			\centering
			\begin{subfigure}{0.23\textwidth}
				\centering
				\includegraphics[keepaspectratio=true, width=\textwidth, height=0.23\textheight]{discussion/img/ferdosi_3_120000_mbe_sambe.png}
				\caption{Dataset \ferdosiThree}
				\label{fig:discussion:performance:mbevssambe:ferdosi3}
			\end{subfigure}
			\begin{subfigure}{0.23\textwidth}
				\centering
				\includegraphics[keepaspectratio=true, width=\textwidth, height=0.23\textheight]{discussion/img/baakman_3_120000_mbe_sambe.png}
				\caption{Dataset \baakmanThree}
				\label{fig:discussion:performance:mbevssambe:baakman3}
			\end{subfigure}	
			\caption{Plots of the density estimated by \sambe as a function of those estimated by \mbe for dataset %
				\subref{fig:discussion:performance:mbevssambe:ferdosi3} % 
				\ferdosiThree and %
				\subref{fig:discussion:performance:mbevssambe:baakman3} %
				\baakmanThree.
			}
			\label{fig:discussion:performance:four:mbevssambe}
		\end{figure}

	% Where are the differences largest -> plots
	% Single Sphere
	The plots in \cref{fig:discussion:performance:singleSphere:mbeLowerError} emphasizes the points in dataset \ferdosiOne through \baakmanOne where the absolute error of \mbe is smaller than that of \sambe. These plots show that the shape-adaptive kernels outperforms the symmetric kernels near the borders of the datasets.
		% Why the boundary effect
		We expect that the boundary effect is due to the strong anisotropy of the local neighborhood of the points near the boundaries. After all these neighborhoods all point strongly towards the dataset. Consequently the domain of the shape-adaptive kernels extends less outside of the boundaries dataset than the domains of the symmetric kernels. This is results in less underestimating of densities near the boundary of the dataset if shape-adaptive kernels are used.
		% Why is it stonger of the Gaussian is more anisotropic
		Furthermore the strength of the boundary effect seems to increase as the Gaussian component of the dataset is more anisotropic. However the seemingly better performance of \sambe is due to an increase in the number of points where the density estimated by \sambe equals that estimated by \mbe. In dataset \ferdosiOne the density estimates of the two estimators differ on all points, however this percentage increases as the anisotropy of the Gaussian component increases, to \SI{3.535329901731399e+01}{\percent} in dataset \baakmanFive. 
		%SAMBE == MBE
		%Ferdosi 1 (0.000000000000000e+00 percent)
		%Baakman 1 (1.327294605254362e+01 percent)
		%Baakman 4 (2.989838892974129e+01 percent)
		%Baakman 5 (3.535329901731399e+01 percent)
		As the Gaussian component becomes more anisotropic there are more points whose local neighborhood consists only of uniform noise. On average the covariance matrix of neighborhoods that contain primarily points sampled from the noise component should be scalar. Consequently the shape-adaptive kernels of a large number of points sampled from the noise component are symmetric, resulting in points where the estimators give the same approximated density.
	
	% Multi Sphere
	The points where using symmetric kernels results in a smaller error in datasets \ferdosiTwo through \baakmanThree are emphasized in
	\cref{fig:discussion:performance:multisphere:mbeLowerError}. We contribute the boundary effect in these datasets to the same cause as the boundary effects in the datasets with a single Gaussian component. Interestingly the points dataset \ferdosiThree and \baakmanThree where the absolute error of \mbe is lower approximate a sphere, contrary to the cube they define for dataset \ferdosiTwo and \baakmanTwo. It is our expectation that this is caused by smaller distance between the means of the Gaussian components and the boundary of the dataset. 

	\begin{figure}
		\centering
		\begin{subfigure}{0.23\textwidth}
			\centering
			\includegraphics[keepaspectratio=true, width=\textwidth, height=0.23\textheight]{discussion/img/ferdosi_1_abs_error_mbeSmallerThansambe}
			\caption{Dataset \ferdosiOne}
			\label{fig:discussion:performance:mbeLowerError:ferdosi1}
		\end{subfigure}
		\begin{subfigure}{0.23\textwidth}
			\centering
			\includegraphics[keepaspectratio=true, width=\textwidth, height=0.23\textheight]{discussion/img/baakman_1_abs_error_mbeSmallerThansambe}
			\caption{Dataset \baakmanOne}
			\label{fig:discussion:performance:mbeLowerError:baakman1}
		\end{subfigure}	
		\begin{subfigure}{0.23\textwidth}
			\centering
			\includegraphics[keepaspectratio=true, width=\textwidth, height=0.23\textheight]{discussion/img/baakman_4_abs_error_mbeSmallerThansambe}
			\caption{Dataset \baakmanFour}
			\label{fig:discussion:performance:mbeLowerError:baakman4}
		\end{subfigure}		
		\begin{subfigure}{0.23\textwidth}
			\centering
			\includegraphics[keepaspectratio=true, width=\textwidth, height=0.23\textheight]{discussion/img/baakman_5_abs_error_mbeSmallerThansambe}
			\caption{Dataset \baakmanFive}
			\label{fig:discussion:performance:mbeLowerError:baakman5}
		\end{subfigure}			
		\caption{Low opacity scatter plot of dataset %
			\subref{fig:discussion:performance:mbeLowerError:ferdosi1} \ferdosiOne, %
			\subref{fig:discussion:performance:mbeLowerError:baakman1} \baakmanOne, %
			\subref{fig:discussion:performance:mbeLowerError:baakman4} \baakmanFour, and%
			\subref{fig:discussion:performance:mbeLowerError:baakman5} \baakmanFive, %
			with an overlay of larger colored points where the absolute error of \sambe is larger than the absolute error of \mbe.}
		\label{fig:discussion:performance:singleSphere:mbeLowerError}
	\end{figure}
	
	\begin{figure}
		\centering
		\begin{subfigure}{0.23\textwidth}
			\centering
			\includegraphics[keepaspectratio=true, width=\textwidth, height=0.23\textheight]{discussion/img/ferdosi_2_abs_error_mbeSmallerThansambe}
			\caption{Dataset \ferdosiTwo}
			\label{fig:discussion:performance:mbeLowerError:ferdosi2}
		\end{subfigure}
		\begin{subfigure}{0.23\textwidth}
			\centering
			\includegraphics[keepaspectratio=true, width=\textwidth, height=0.23\textheight]{discussion/img/baakman_2_abs_error_mbeSmallerThansambe}
			\caption{Dataset \baakmanTwo}
			\label{fig:discussion:performance:mbeLowerError:baakman2}
		\end{subfigure}	
		\begin{subfigure}{0.23\textwidth}
			\centering
			\includegraphics[keepaspectratio=true, width=\textwidth, height=0.23\textheight]{discussion/img/ferdosi_3_abs_error_mbeSmallerThansambe}
			\caption{Dataset \ferdosiThree}
			\label{fig:discussion:performance:mbeLowerError:ferdosi3}
		\end{subfigure}
		\begin{subfigure}{0.23\textwidth}
			\centering
			\includegraphics[keepaspectratio=true, width=\textwidth, height=0.23\textheight]{discussion/img/baakman_3_abs_error_mbeSmallerThansambe}
			\caption{Dataset \baakmanThree}
			\label{fig:discussion:performance:mbeLowerError:baakman3}
		\end{subfigure}			
		\caption{Low opacity scatter plot of dataset %
			\subref{fig:discussion:performance:mbeLowerError:ferdosi2} \ferdosiTwo, %
			\subref{fig:discussion:performance:mbeLowerError:baakman2} \baakmanTwo, %
			\subref{fig:discussion:performance:mbeLowerError:ferdosi3} \ferdosiThree, and %
			\subref{fig:discussion:performance:mbeLowerError:baakman3} \baakmanThree %
			with an overlay of high opacity larger points where the absolute error of \mbe is smaller than that of \sambe.}
		\label{fig:discussion:performance:multisphere:mbeLowerError}
	\end{figure}		


	% IN SOME NEIGHBOURHOODS THE SHAPE ADAPTIVE KERNELS HELP! IN OTHERS THEY SCREW THINGS UP.
	% Suggest increasing K, what did ur small experiment with increasing K show?
	% Suggest not always using a shape-adaptive kernel